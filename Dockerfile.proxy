FROM python:3.12-slim

WORKDIR /app

# Copy dependency files
COPY pyproject.toml uv.lock ./

# Install uv and dependencies
RUN pip install --no-cache-dir uv && \
    uv sync --frozen

# Copy application files
COPY proxy_server.py .
COPY mtls_http_client.py .
COPY http_client.py .

# Expose proxy server port
EXPOSE 8080

# Run proxy server
CMD ["uv", "run", "python", "proxy_server.py", "--host", "0.0.0.0"]
